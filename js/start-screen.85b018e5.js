(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["start-screen"],{"09ed":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"startScreen"},[s("div",{staticClass:"waitSplash"},[s("div",{staticClass:"img",style:`background-image:url('${t.getImgUrl("hourglass")}')`,attrs:{alt:"hourglass"}}),s("div",{staticClass:"text"},[t._v(t._s(t._f("t")("connectingWait",t.$store.state.locale)))])]),s("big-button",{on:{onClick:t.cancel}},[t._v(t._s(t._f("t")("cancel",t.$store.state.locale)))])],1)},n=[],o=(e("14d9"),e("cb19")),r=e("6932"),l={components:{BigButton:r["a"]},name:"startScreen",mounted(){this.$services.itmr=new o["a"](8666,this.$store.state.locale),this.$services.itmr.events.onConnect=()=>{this.$router.push("/channels")}},methods:{cancel(){this.$services.itmr.stopSearch(),this.$router.push("/")}}},c=l,h=(e("94c2"),e("2877")),a=Object(h["a"])(c,i,n,!1,null,null,null);s["default"]=a.exports},7192:function(t,s,e){"use strict";e.d(s,"a",(function(){return i}));e("e073"),e("74de");class i{constructor(t,s,e=null,i=null,n=null,o=null,r=null,l=null,c=null){this.name=t,this.value=s,this.pos=e,this.color=i,this.blink=n,this.size=o,this.isCenter=r,this.postfix=l,this.prefix=c}setPos(t){this.pos=t}setText(t){this.value=t}setPostfix(t){this.postfix=t}setPrefix(t){this.prefix=t}setColor(t){this.color=t}setBlink(t){this.blink=t}removeBlink(){this.blink=null}setSize(t){this.size=t}setCenter(t){this.isCenter=t}prepare(){let t={};return t["name"]=this.name,t["value"]=this.postfix?`${this.value} ${this.postfix}`:this.value,t["value"]=this.prefix?`${this.prefix} ${t["value"]}`:t["value"],this.pos&&(t["pos"]=this.pos),this.color&&(t["color"]=this.color),this.blink&&(t["blink"]=this.blink),this.size&&(t["size"]=this.size),this.isCenter&&(t["isCenter"]=this.isCenter),t}equals(t){if(null==t)return!1;let s=this.prepare();return(null===s||void 0===s?void 0:s.name)==(null===t||void 0===t?void 0:t.name)&&(null===s||void 0===s?void 0:s.value)==(null===t||void 0===t?void 0:t.value)&&(null===s||void 0===s?void 0:s.pos)==(null===t||void 0===t?void 0:t.pos)&&(null===s||void 0===s?void 0:s.color)==(null===t||void 0===t?void 0:t.color)&&(null===s||void 0===s?void 0:s.blink)==(null===t||void 0===t?void 0:t.blink)&&(null===s||void 0===s?void 0:s.size)==(null===t||void 0===t?void 0:t.size)&&(null===s||void 0===s?void 0:s.postfix)==(null===t||void 0===t?void 0:t.postfix)&&(null===s||void 0===s?void 0:s.prefix)==(null===t||void 0===t?void 0:t.prefix)&&(null===s||void 0===s?void 0:s.isCenter)==(null===t||void 0===t?void 0:t.isCenter)}}},"74de":function(t,s,e){"use strict"},"7a79":function(t,s,e){},"94c2":function(t,s,e){"use strict";e("7a79")},cb19:function(t,s,e){"use strict";e.d(s,"a",(function(){return o}));var i=e("7192"),n=e("fece");class o{constructor(t=8666,s="en"){this.stats={success:0,errors:0},this.isConnected=!1,this.events={onConnect:()=>{},onReconnect:()=>{}},this.port=t,this.lang=s,this.handlers={},this.checkOutputTimer=null,this.searchServerTimer=setInterval(this.search.bind(this),1e3),this.consoleStyle="background-color: #EFD8CD; color: #473A3C; border-radius: 100px;padding: 1px 4px;",this._log("Search game server...")}search(){fetch("http://localhost:"+this.port,{method:"POST",body:'||{"m":"ping"}||\n'}).then(t=>t.json()).then(t=>{"pong"==t.out&&(this._log("Game server found"),clearInterval(this.searchServerTimer),this.connect())}).catch(t=>{})}stopSearch(){clearInterval(this.searchServerTimer)}testConnect(){setInterval(()=>{fetch("http://localhost:"+this.port,{method:"POST",body:'||{"m":"ping"}||\n'}).then(t=>t.json()).then(t=>{"pong"==t.out&&this.stats.success++}).catch(t=>{this.stats.errors++}),this._log(`${this.stats.success}|${this.stats.errors} / ${Math.round(this.stats.errors/(this.stats.success+this.stats.errors)*100,2)}%`)},250)}connect(){this.sendToGame({m:"connect"}).then(t=>{"success"==t.out&&(this._log("Game connected"),this.isConnected=!0,this.clearAll().then(()=>{this.sendToGame({m:"addText",d:[new i["a"]("gameConnected",Object(n["a"])("gameConnected",this.lang)).prepare()]}),this._signal("onConnect")}))})}clearAll(){return Promise.all([this.sendToGame({m:"removePollframes"},!0),this.sendToGame({m:"removeProgressBar"},!0),this.sendToGame({m:"clearText"},!0)])}sendToGame(t,s=!1,e=0){return new Promise((i,n)=>{this._send(t,e,s).then(t=>t.json()).catch(t=>{console.error(t),n(t)}).then(t=>{this.isConnected=!0,i(t)}).catch(t=>{console.error(t)})})}checkOutput(){fetch("http://localhost:"+this.port,{method:"POST",body:'||{"m":"out"}||\n'}).then(t=>t.json()).then(t=>{this.isConnected||(console.log("send reconnect"),this.sendToGame({m:"removeText",d:["siteMessage"]}),this._signal("onReconnect")),this.isConnected=!0,t.out.forEach(t=>{this.handlers[t.c]?this.handlers[t.c](t.d):this._log("Not found handler for "+t.c)})}).catch(t=>{this.isConnected=!1,this._log("Connection to Isaac skip request","warn")})}addHandler(t,s){this.handlers[t]=s}removeHandler(t){delete this.handlers[t]}_signal(t,s=null){this.events[t]&&this.events[t](s)}_log(t,s="log"){console[s]("%cITMR%c "+t,this.consoleStyle,"")}_send(t,s=1,e=!1){return fetch("http://localhost:"+this.port,{method:"POST",body:`||${JSON.stringify(t)}||\n`}).catch(function(i){if(this.isConnected=!1,this._log("Connection to Isaac is broken","error"),s>3&&!e)throw i;if(s>6&&e)throw i;return this._send(t,s+1,e)}.bind(this))}}},e073:function(t,s,e){"use strict";e.d(s,"a",(function(){return i}));class i{constructor(t,s,e,i){this.r=t/255,this.g=s/255,this.b=e/255,this.a=i}}},fece:function(t,s,e){"use strict";e.d(s,"a",(function(){return o}));var i=e("3f83"),n=e("9478");function o(t,s){return"ru"==s?n["a"].strings[t]?n["a"].strings[t]:`!${t}!`:i["a"].strings[t]?i["a"].strings[t]:`!${t}!`}}}]);
//# sourceMappingURL=start-screen.85b018e5.js.map