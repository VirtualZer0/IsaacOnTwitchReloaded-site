(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["gamemode-screen"],{"00ee":function(t,e,s){var i=s("b622"),n=i("toStringTag"),a={};a[n]="z",t.exports="[object z]"===String(a)},"0d26":function(t,e,s){var i=s("e330"),n=Error,a=i("".replace),r=function(t){return String(n(t).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,l=o.test(r);t.exports=function(t,e){if(l&&"string"==typeof t&&!n.prepareStackTrace)while(e--)t=a(t,o,"");return t}},"0f61":function(t,e,s){"use strict";s("31a5")},"2ba4":function(t,e,s){var i=s("40d5"),n=Function.prototype,a=n.apply,r=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?r.bind(a):function(){return r.apply(a,arguments)})},"31a5":function(t,e,s){},"3bbe":function(t,e,s){var i=s("1626"),n=String,a=TypeError;t.exports=function(t){if("object"==typeof t||i(t))return t;throw a("Can't set "+n(t)+" as a prototype")}},"483c":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"gamemodeScreen"},[e("h1",[t._v(t._s(t._f("t")("gamemode",t.$store.state.locale)))]),e("div",{staticClass:"panel-container"},[e("div",{staticClass:"panel hoverable",on:{click:function(e){return t.start(0)}}},[e("h2",[t._v(t._s(t._f("t")("easy",t.$store.state.locale)))]),e("p",[t._v(t._s(t._f("t")("easyDesc",t.$store.state.locale)))]),e("img",{attrs:{src:t.getImgUrl("easyImg")}})]),e("div",{staticClass:"panel hoverable",on:{click:function(e){return t.start(1)}}},[e("h2",[t._v(t._s(t._f("t")("default",t.$store.state.locale)))]),e("p",[t._v(t._s(t._f("t")("defaultDesc",t.$store.state.locale)))]),e("img",{attrs:{src:t.getImgUrl("defaultImg")}})]),e("div",{staticClass:"panel hoverable",on:{click:function(e){return t.start(2)}}},[e("h2",[t._v(t._s(t._f("t")("crazy",t.$store.state.locale)))]),e("p",[t._v(t._s(t._f("t")("crazyDesc",t.$store.state.locale)))]),e("img",{attrs:{src:t.getImgUrl("crazyImg")}})])])])},n=[],a=(s("14d9"),s("6932")),r=s("fece"),o=s("e073"),l={white:new o["a"](255,255,255,1),lightGray:new o["a"](192,192,192,1),gray:new o["a"](128,128,128,1),darkGray:new o["a"](64,64,64,1),black:new o["a"](0,0,0,1),red:new o["a"](255,0,0,1),yellow:new o["a"](255,215,0,1)};const h={EASY:0,NORMAL:1,CRAZY:2};var c=s("7192");s("d9e2");function u(t,e){let s=new Array(e),i=t.length,n=new Array(i);if(e>i)throw new RangeError("getRandomElementsFromArr: more elements taken than available");while(e--){let a=Math.floor(Math.random()*i);s[e]=t[a in n?n[a]:a],n[a]=--i in n?n[i]:i}return s}function d(t){let e,s=[];for(e=0;e<t.length;e++)s[e]=t[e].weight+(s[e-1]||0);let i=Math.random()*s[s.length-1];for(e=0;e<s.length;e++)if(s[e]>i)break;return t[e]}function p(t){for(var e="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=s.length,n=0;n<t;n++)e+=s.charAt(Math.floor(Math.random()*i));return e}function m(t){return v(t.replace(/^#/,"").replace("_NAME","").replace("_"," ").replace("MOMS ","Mom's ").replace("DADS ","Dad's "))}function v(t){for(var e=t.toLowerCase().split(" "),s=0;s<e.length;s++)e[s]=e[s].charAt(0).toUpperCase()+e[s].substring(1);return e.join(" ")}var g=[{name:"Neonomi",twitch:"neonomi",youtube:"UChDAzHts9B7sZIvq9NqtW7g",trinket:"Neo glasses"},{name:"Hutts",twitch:"huttsgaming",youtube:"UCy3avhfHpBbbgwZpNvuVklg",trinket:"Hair clap"},{name:"Tijoe",twitch:"tijoe",youtube:"UCpcg8-wx6SOW3PfGT83E-BA",trinket:"Torn fox ear"},{name:"Rekvizit8bit",twitch:"rekvizit8bit",youtube:"UCSa-d35XCyltUYHZBDbq5mg",trinket:"Gribulya's piece"},{name:"Vertox",twitch:"vertroxmt",youtube:"UCMJr3O_NEpDSxqb9cYrZvcA",trinket:"Spacesuit charge indicator"},{name:"Mr. Ost",twitch:null,youtube:"UCyvSgWv830voOV6Nwqjwo4w",trinket:"Greed coin eye"},{name:"Crystal Channel",twitch:"crystalous",youtube:"UCKF1jFt8PUs240B7ccRXDfw",trinket:"Crystal shard"},{name:"Grizzly Guy",twitch:"grizzlyguygaming",youtube:null,trinket:"Grizzly claw"},{name:"HellYeah Play",twitch:"hellyeahplay",youtube:"UCMpHpyOyoYj_7uei_sF342Q",trinket:"Inverted Cross"},{name:"Vitec Play",twitch:"vitecp",youtube:"UCXHczq_8PytR6mEJeUTTrqw",trinket:"UC's stem"},{name:"Melharucos",twitch:"melharucos",youtube:null,trinket:"Spider eye"},{name:"D4N9",twitch:"d4n9_twitch",youtube:"UCIo6gZsEszFf66M0V3WHEAA",trinket:"Broken D4-R4 console"},{name:"bmvanquisher",twitch:"bmvanquisher",youtube:null,trinket:"Pug tail"}];s("e342"),s("c745"),s("cb19"),s("6e74");class f{constructor(t){this.Isaac=t,this.ready=!0,this.pollEnd=!1,this.freezed=!1,this.text={firstline:new c["a"](`p_${p(8)}_f`,"",t.settings.textpos.l1,l.yellow),secondline:new c["a"](`p_${p(8)}_s`,"",t.settings.textpos.l2)}}handleMessage(t){return!0}prepare(){}update(){this.freezed&&this.unfreeze()}freeze(){this.freezed=!0}unfreeze(){this.freezed=!1}}var x=["#THE_POLAROID_NAME","#THE_NEGATIVE_NAME","#KEY_PIECE_1_NAME","#KEY_PIECE_2_NAME","#BROKEN_SHOVEL_NAME","#BROKEN_SHOVEL2_NAME","#MOMS_SHOVEL_NAME","#KNIFE_PIECE_1_NAME","#KNIFE_PIECE_2_NAME","#DADS_NOTE_NAME","#DOGMA_NAME","#DEATH_CERTIFICATE_NAME","#BAG_OF_CRAFTING_NAME","#FLIP_NAME","#RECALL_NAME","#HOLD_NAME"];s("74de");class b extends f{constructor(t,e,s){super(t),this.votes=[0,0,0],this.allVotesCount=0,this.users={},this.variants=[],this.pollTime=e,this.delayTime=s,this.isFirstUpdate=!0,this.text.secondline=[new c["a"](`p_${p(8)}_s1`,"",t.settings.textpos.l2),new c["a"](`p_${p(8)}_s2`,"",{X:t.settings.textpos.l2.X+90,Y:t.settings.textpos.l2.Y}),new c["a"](`p_${p(8)}_s3`,"",{X:t.settings.textpos.l2.X+180,Y:t.settings.textpos.l2.Y})]}update(){var t,e,s,i,n;(super.update(),this.isFirstUpdate)&&(this.Isaac.services.itmr.sendToGame({m:"addPollframes",d:{f1:null===(t=this.variants[0])||void 0===t?void 0:t.gfx,f2:null===(e=this.variants[1])||void 0===e?void 0:e.gfx,f3:null===(s=this.variants[2])||void 0===s?void 0:s.gfx}}),this.isFirstUpdate=!1);if(this.pollEnd)this.delayTime>0?(this.Isaac.isPaused||this.delayTime--,null===(i=(n=this.text.firstline).setPostfix)||void 0===i||i.call(n,` (${this.delayTime}${Object(r["a"])("s",this.Isaac.lang)})`)):(this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.firstline.name]}),this.text.firstline=null,this.text.secondline=null,this.Isaac.runNextAction());else if(this.pollTime>0){var a,o;this.Isaac.isPaused||this.pollTime--,null===(a=(o=this.text.firstline).setPostfix)||void 0===a||a.call(o,` (${this.pollTime}${Object(r["a"])("s",this.Isaac.lang)})`);let t=this.getPollText();for(let e=0;e<t.length;e++){var l,h;null===(l=(h=this.text.secondline[e]).setText)||void 0===l||l.call(h,t[e])}}else this.pollEnd=!0,this.endPoll(),this.Isaac.prepareNextAction();let c=[];var u,d,p,m,v,g,f,x,b;this.text.firstline&&this.text.firstline.prepare&&(null===(u=this.text.firstline)||void 0===u||u.setPos(this.Isaac.settings.textpos.l1),c.push(this.text.firstline.prepare()));this.text.secondline&&(null===(d=(p=this.text.secondline[0]).setPos)||void 0===d||d.call(p,this.Isaac.settings.textpos.l2),null===(m=(v=this.text.secondline[1]).setPos)||void 0===m||m.call(v,{X:this.Isaac.settings.textpos.l2.X+90,Y:this.Isaac.settings.textpos.l2.Y}),null===(g=(f=this.text.secondline[2]).setPos)||void 0===g||g.call(f,{X:this.Isaac.settings.textpos.l2.X+180,Y:this.Isaac.settings.textpos.l2.Y}),null===(x=(b=this.text.secondline).forEach)||void 0===x||x.call(b,t=>{c.push(t.prepare())}));c.length>0&&this.Isaac.services.itmr.sendToGame({m:"addText",d:c})}endPoll(){this.text.firstline.setBlink(l.white),this.Isaac.services.itmr.sendToGame({m:"removePollframes"}),this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.secondline[0].name,this.text.secondline[1].name,this.text.secondline[2].name]}),this.text.secondline=null}handleMessaage(t){return"#1"==t.text||"1"==t.text||t.text.toUpperCase()==this.variants[0].name.toUpperCase()?(this.voteFor(0,`${t.source}${t.userId}`),!1):"#2"==t.text||"2"==t.text||t.text.toUpperCase()==this.variants[1].name.toUpperCase()?(this.voteFor(1,`${t.source}${t.userId}`),!1):"#3"!=t.text&&"3"!=t.text&&t.text.toUpperCase()!=this.variants[2].name.toUpperCase()||(this.voteFor(2,`${t.source}${t.userId}`),!1)}voteFor(t,e){this.pollEnd||(this.Isaac.specialTriggers.triggers.russianHackers.enabled&&(t=this.Isaac.specialTriggers.triggers.russianHackers.shuffle[t]),"undefined"!==typeof this.users[e]&&t!=this.users[e]?(this.votes[this.users[e]]--,this.votes[t]++,this.users[e]=t):"undefined"===typeof this.users[e]&&(this.votes[t]++,this.users[e]=t,this.allVotesCount++))}getWinner(){return this.votes[0]==this.votes[1]&&this.votes[1]==this.votes[2]||0==this.allVotesCount?this.variants[Math.floor(Math.random()*this.variants.length)]:this.votes[0]==this.votes[1]&&this.votes[2]<this.votes[0]?Math.random()>.5?this.variants[1]:this.variants[0]:this.votes[1]==this.votes[2]&&this.votes[0]<this.votes[1]?Math.random()>.5?this.variants[2]:this.variants[1]:this.votes[0]==this.votes[2]&&this.votes[1]<this.votes[0]?Math.random()>.5?this.variants[2]:this.variants[0]:this.variants[this.votes.indexOf(Math.max(...this.votes))]}getPercents(t){return this.Isaac.settings.hideVotes?"-":0==this.allVotesCount?0:Math.round(this.votes[t]/this.allVotesCount*100)}getPollText(){return[`#1            ${this.getPercents(0)}%`,`#2            ${this.getPercents(1)}%`,`#3            ${this.getPercents(2)}%`]}freeze(){super.freeze(),this.pollEnd?this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.firstline.name]}):(this.Isaac.services.itmr.sendToGame({m:"removePollframes"}),this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.firstline.name,this.text.secondline[0].name,this.text.secondline[1].name,this.text.secondline[2].name]}))}unfreeze(){var t,e,s;(super.unfreeze(),this.pollEnd)||this.Isaac.services.itmr.sendToGame({m:"addPollframes",d:{f1:null===(t=this.variants[0])||void 0===t?void 0:t.gfx,f2:null===(e=this.variants[1])||void 0===e?void 0:e.gfx,f3:null===(s=this.variants[2])||void 0===s?void 0:s.gfx}})}}class y extends b{constructor(t,e,s){super(t,e,s),this.items=this.Isaac.lists.items,this.action="",this.ready=!1}prepare(){this.Isaac.services.itmr.sendToGame({m:"getPlayerItems"}).then(t=>this.setReady(t.out))}setReady(t){try{2!=this.Isaac.gamemode&&(t=t.filter(t=>!x.some(e=>{var s;return t==(null===(s=this.items.find(t=>t.name==e))||void 0===s?void 0:s.id)})))}catch(e){console.log("Error in ignorableItems.js")}if(Math.random()<this.Isaac.settings.chances.removeItems/10&&t.length>3){this.action="removeItem",this.text.firstline.setText(Object(r["a"])("selectItemForRemove",this.Isaac.lang));let e=u(t,3).map(t=>this.items.find(e=>e.id==t));this.variants=e}else{this.action="giveItem",this.text.firstline.setText(Object(r["a"])("selectItem",this.Isaac.lang));let e=[];e=2!=this.Isaac.gamemode?this.items.filter(e=>!(t.some(t=>t==(null===e||void 0===e?void 0:e.id))||e.special||x.some(t=>t==e.name))):this.items.filter(e=>!t.some(t=>t==e.id)),this.variants=u(e,3)}this.ready=!0}endPoll(){super.endPoll();let t=this.getWinner();switch(this.action){case"giveItem":this.text.firstline.setText(`${Object(r["a"])("pollGiveResult",this.Isaac.lang)} ${m(t.name)}`),this.Isaac.services.itmr.sendToGame({m:"itemAction",d:{remove:!1,item:t.id}},!0);break;case"removeItem":this.text.firstline.setText(`${Object(r["a"])("pollRemoveResult",this.Isaac.lang)} ${m(t.name)}`),this.Isaac.services.itmr.sendToGame({m:"itemAction",d:{remove:!0,item:t.id}},!0);break}}}class w extends f{constructor(t,e,s){super(t),this.votes=[0,0,0],this.allVotesCount=0,this.users={},this.variants=[],this.pollTime=e,this.delayTime=s}update(){var t,e,s,i,n,a;(super.update(),this.pollEnd)?this.delayTime>0?(this.Isaac.isPaused||this.delayTime--,null===(t=(e=this.text.firstline).setPostfix)||void 0===t||t.call(e,` (${this.delayTime}${Object(r["a"])("s",this.Isaac.lang)})`)):(this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.firstline.name,this.text.secondline.name]}),this.text.firstline=null,this.text.secondline=null,this.Isaac.runNextAction()):this.pollTime>0?(null===(s=(i=this.text.firstline).setPostfix)||void 0===s||s.call(i,` (${this.pollTime}${Object(r["a"])("s",this.Isaac.lang)})`),null===(n=(a=this.text.secondline).setText)||void 0===n||n.call(a,this.getPollText()),this.Isaac.isPaused||this.pollTime--):(this.pollEnd=!0,this.endPoll(),this.Isaac.prepareNextAction());let o=[];this.text.firstline&&this.text.firstline.prepare&&o.push(this.text.firstline.prepare()),this.text.secondline&&this.text.secondline.prepare&&o.push(this.text.secondline.prepare()),o.length>0&&this.Isaac.services.itmr.sendToGame({m:"addText",d:o})}endPoll(){var t,e;this.text.firstline.setBlink(l.white),null===(t=(e=this.text.firstline).setPostfix)||void 0===t||t.call(e,` (${this.delayTime}${Object(r["a"])("s",this.Isaac.lang)})`)}handleMessaage(t){if(!this.pollEnd)return"#1"==t.text||"1"==t.text||t.text.toUpperCase()==this.variants[0].name.toUpperCase()?(this.voteFor(0,`${t.source}${t.userId}`),!1):"#2"==t.text||"2"==t.text||t.text.toUpperCase()==this.variants[1].name.toUpperCase()?(this.voteFor(1,`${t.source}${t.userId}`),!1):"#3"!=t.text&&"3"!=t.text&&t.text.toUpperCase()!=this.variants[2].name.toUpperCase()||(this.voteFor(2,`${t.source}${t.userId}`),!1)}voteFor(t,e){this.pollEnd||(this.Isaac.specialTriggers.triggers.russianHackers.enabled&&(t=this.Isaac.specialTriggers.triggers.russianHackers.shuffle[t]),"undefined"!==typeof this.users[e]&&t!=this.users[e]?(this.votes[this.users[e]]--,this.votes[t]++,this.users[e]=t):"undefined"===typeof this.users[e]&&(this.votes[t]++,this.users[e]=t,this.allVotesCount++))}getWinner(){return this.votes[0]==this.votes[1]&&this.votes[1]==this.votes[2]||0==this.allVotesCount?this.variants[Math.floor(Math.random()*this.variants.length)]:this.votes[0]==this.votes[1]&&this.votes[2]<this.votes[0]?Math.random()>.5?this.variants[1]:this.variants[0]:this.votes[1]==this.votes[2]&&this.votes[0]<this.votes[1]?Math.random()>.5?this.variants[2]:this.variants[1]:this.votes[0]==this.votes[2]&&this.votes[1]<this.votes[0]?Math.random()>.5?this.variants[2]:this.variants[0]:this.variants[this.votes.indexOf(Math.max(...this.votes))]}getPercents(t){return this.Isaac.settings.hideVotes?"-":0==this.allVotesCount?0:Math.round(this.votes[t]/this.allVotesCount*100)}getPollText(){let t=`#1 ${this.variants[0].name} - ${this.getPercents(0)}%  `;return t+=`#2 ${this.variants[1].name} - ${this.getPercents(1)}%  `,t+=`#3 ${this.variants[2].name} - ${this.getPercents(2)}%`,t}freeze(){super.freeze()}unfreeze(){super.unfreeze()}}class T extends w{constructor(t,e,s){super(t,e,s);let i=this.Isaac.lists.events.map(e=>({id:e.id,name:e.name,weight:e.weights[t.gamemode],desc:e.desc,specialTrigger:e.specialTrigger,msgTrigger:e.msgTrigger}));for(let n=0;n<3;n++)i=i.filter(t=>!this.variants.some(e=>e.id==t.id)),this.variants.push(d(i));this.text.firstline.setText(Object(r["a"])("selectEvent",this.Isaac.lang)),this.text.secondline.setText(this.getPollText())}update(){if(super.update(),0==this.delayTime){let t=this.getWinner();t.specialTrigger&&this.Isaac.specialTriggers.activate(t.specialTrigger)}}endPoll(){super.endPoll();let t=this.getWinner();this.text.firstline.setText(`${Object(r["a"])("selectedEvent",this.Isaac.lang)} ${t.name}`),this.text.secondline.setText(t.desc),this.text.secondline.setColor(l.lightGray),this.Isaac.services.itmr.sendToGame({m:"eventAction",d:{id:t.id}},!0)}freeze(){super.freeze(),this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.firstline.name,this.text.secondline.name]})}unfreeze(){super.unfreeze()}}class I extends b{constructor(t,e,s){super(t,e,s),this.trinkets=t.lists.trinkets,this.text.firstline.setText(Object(r["a"])("selectTrinket",this.Isaac.lang)),this.variants=u(this.trinkets,3)}endPoll(){super.endPoll();let t=this.getWinner();this.text.firstline.setText(`${Object(r["a"])("pollGiveResult",this.Isaac.lang)} ${m(t.name)}`),this.Isaac.services.itmr.sendToGame({m:"trinketAction",d:{trinket:t.id}},!0)}}class k extends f{constructor(t,e,s){super(t),this.positiveVotes=1,this.allVotesCount=2,this.pollType=null,this.users={},this.pollTime=e,this.delayTime=s,this.isFirstUpdate=!0,this.ready=!1,this.fillerVotes=!0,this.text.secondline=null}prepare(){this.Isaac.services.itmr.sendToGame({m:"getPlayerType"}).then(t=>this.setReady(t.out))}setReady(t){let e=[{name:"Pockets",title:Object(r["a"])("selectPockets",this.Isaac.lang),sectors:["none","pill","card","redcard","momcard","humanitycard","rune","blackrune","holycard","diceshard","creditcard"]},{name:"Keys",title:Object(r["a"])("selectKeys",this.Isaac.lang),sectors:["half",-2,-1,0,1,2,3,"gold"]},{name:"Bombs",title:Object(r["a"])("selectBombs",this.Isaac.lang),sectors:["half",-2,-1,0,1,2,3,"gold"]},{name:"Coins",title:Object(r["a"])("selectCoins",this.Isaac.lang),sectors:["half",-2,-1,0,1,2,5,10]}];10!=t&&14!=t&&e.push({name:"Hearts",title:Object(r["a"])("selectHearts",this.Isaac.lang),sectors:["none","halfred","halfsoul","red","soul","gold","black","twitch","bone","container","rainbow"]}),this.pollType=e[Math.floor(Math.random()*e.length)],this.ready=!0}update(){var t,e;(super.update(),this.isFirstUpdate&&(this.Isaac.services.itmr.sendToGame({m:"addProgressBar",d:{barType:this.pollType.name,title:`${this.Isaac.specialTriggers.getFirstlineModifier()} ${this.pollType.title} (${this.pollTime}${Object(r["a"])("s",this.Isaac.lang)})`,min:0,value:1,max:2,sectors:this.pollType.sectors.length}}),this.isFirstUpdate=!1),this.pollEnd)?this.delayTime>0?(this.Isaac.isPaused||this.delayTime--,null===(t=(e=this.text.firstline).setPostfix)||void 0===t||t.call(e,` (${this.delayTime}${Object(r["a"])("s",this.Isaac.lang)})`)):(this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.firstline.name]}),this.text.firstline=null,this.Isaac.runNextAction()):this.pollTime>0?(this.Isaac.services.itmr.sendToGame({m:"setProgressBar",d:{title:`${this.Isaac.specialTriggers.getFirstlineModifier()} ${this.pollType.title} (${this.pollTime}${Object(r["a"])("s",this.Isaac.lang)})`,min:0,value:this.positiveVotes,max:this.allVotesCount}}),this.Isaac.isPaused||this.pollTime--):(this.endPoll(),this.Isaac.prepareNextAction());let s=[];this.text.firstline&&this.text.firstline.prepare&&this.pollEnd&&s.push(this.text.firstline.prepare()),s.length>0&&this.Isaac.services.itmr.sendToGame({m:"addText",d:s})}endPoll(){var t,e;this.pollEnd=!0,this.Isaac.services.itmr.sendToGame({m:"removeProgressBar"}),this.text.firstline.setBlink(l.white),null===(t=(e=this.text.firstline).setPostfix)||void 0===t||t.call(e,` (${this.delayTime}${Object(r["a"])("s",this.Isaac.lang)})`);let s=this.getWinner();var i,n,a,o,h,c,u,d,p,m;if(this.Isaac.services.itmr.sendToGame({m:"pocketsAction",d:{pickupType:this.pollType.name,value:s}}),"Pockets"==this.pollType.name||"Hearts"==this.pollType.name)"none"==s?null===(i=(n=this.text.firstline).setText)||void 0===i||i.call(n,Object(r["a"])("pollNoneResult",this.Isaac.lang)):null===(a=(o=this.text.firstline).setText)||void 0===a||a.call(o,`${Object(r["a"])("pollGiveResult",this.Isaac.lang)}: ${Object(r["a"])(s,this.Isaac.lang)} ${"Hearts"==this.pollType.name?Object(r["a"])("heart",this.Isaac.lang):""}`);else if(0==s)null===(h=(c=this.text.firstline).setText)||void 0===h||h.call(c,Object(r["a"])("pollNoneResult",this.Isaac.lang));else if("gold"==s)"Keys"==this.pollType.name?null===(u=(d=this.text.firstline).setText)||void 0===u||u.call(d,`${Object(r["a"])("pollGiveResult",this.Isaac.lang)}: ${Object(r["a"])("goldenkey",this.Isaac.lang)}`):null===(p=(m=this.text.firstline).setText)||void 0===p||p.call(m,`${Object(r["a"])("pollGiveResult",this.Isaac.lang)}: ${Object(r["a"])("goldenbomb",this.Isaac.lang)}`);else if("half"==s){var v,g,f,x,b,y;"Keys"==this.pollType.name?null===(v=(g=this.text.firstline).setText)||void 0===v||v.call(g,`${Object(r["a"])("pollRemoveResult",this.Isaac.lang)}: ${Object(r["a"])("halfkeys",this.Isaac.lang)}`):"Bombs"==this.pollType.name?null===(f=(x=this.text.firstline).setText)||void 0===f||f.call(x,`${Object(r["a"])("pollRemoveResult",this.Isaac.lang)}: ${Object(r["a"])("halfbombs",this.Isaac.lang)}`):"Coins"==this.pollType.name&&(null===(b=(y=this.text.firstline).setText)||void 0===b||b.call(y,`${Object(r["a"])("pollRemoveResult",this.Isaac.lang)}: ${Object(r["a"])("halfcoins",this.Isaac.lang)}`))}else if(s>0){var w,T;null===(w=(T=this.text.firstline).setText)||void 0===w||w.call(T,`${Object(r["a"])("pollGiveResult",this.Isaac.lang)}: ${s} ${Object(r["a"])(1==s||-1==s?this.pollType.name.toLowerCase().substr(0,this.pollType.name.length-1):this.pollType.name.toLowerCase(),this.Isaac.lang)}`)}else{var I,k;null===(I=(k=this.text.firstline).setText)||void 0===I||I.call(k,`${Object(r["a"])("pollRemoveResult",this.Isaac.lang)}: ${-1*s} ${Object(r["a"])(this.pollType.name.toLowerCase(),this.Isaac.lang)}`)}}handleMessaage(t){return"MORE"==t.text.toUpperCase()||"БОЛЬШЕ"==t.text.toUpperCase()?(this.voteFor(!0,`${t.source}${t.userId}`),!1):"LESS"!=t.text.toUpperCase()&&"МЕНЬШЕ"!=t.text.toUpperCase()||(this.voteFor(!1,`${t.source}${t.userId}`),!1)}voteFor(t,e){this.pollEnd||(this.Isaac.specialTriggers.triggers.russianHackers.enabled&&(t=!t),"undefined"!==typeof this.users[e]&&t!=this.users[e]?(t?this.positiveVotes++:this.positiveVotes--,this.users[e]=t):"undefined"===typeof this.users[e]&&(t&&this.positiveVotes++,this.users[e]=t,this.allVotesCount++),this.fillerVotes&&(this.positiveVotes--,this.allVotesCount-=2,this.fillerVotes=!1))}getWinner(){return 0==this.positiveVotes?this.pollType.sectors[0]:this.pollType.sectors[Math.ceil(this.positiveVotes/this.allVotesCount*this.pollType.sectors.length)-1]}freeze(){super.freeze(),this.pollEnd?this.Isaac.services.itmr.sendToGame({m:"removeText",d:[this.text.firstline.name]}):this.Isaac.services.itmr.sendToGame({m:"removeProgressBar"})}unfreeze(){super.unfreeze(),this.pollEnd||this.Isaac.services.itmr.sendToGame({m:"addProgressBar",d:{barType:this.pollType.name,title:`${this.Isaac.specialTriggers.getFirstlineModifier()} ${this.pollType.title} (${this.pollTime}${Object(r["a"])("s",this.Isaac.lang)})`,min:0,value:1,max:2,sectors:this.pollType.sectors.length}})}}class _{constructor(t,e,s,i){this.Isaac=t,this.firstline=e,this.secondline=s,this.time=i,this.Isaac.prepareNextAction()}update(){if(this.firstline.setPostfix(` (${this.time}${Object(r["a"])("s",this.Isaac.lang)})`),this.time>0){let t=[];this.firstline&&t.push(this.firstline.prepare()),this.secondline&&t.push(this.secondline.prepare()),this.Isaac.services.itmr.sendToGame({m:"addText",d:t}),this.Isaac.isPaused||this.time--}else{let t=[];this.firstline&&t.push(this.firstline.name),this.secondline&&t.push(this.secondline.name),this.Isaac.services.itmr.sendToGame({m:"removeText",d:t}),this.Isaac.runNextAction()}}freeze(){let t=[];this.firstline&&t.push(this.firstline.name),this.secondline&&t.push(this.secondline.name),this.Isaac.services.itmr.sendToGame({m:"removeText",d:t})}}class C{constructor(){this.triggers={russianHackers:{enabled:!1,shuffle:[],modifier:"[H4CK3D] "}}}activate(t){switch(this.triggers[t].enabled=!0,t){case"russianHackers":this.triggers.russianHackers.shuffle=u([0,1,2],3);break}}stopAll(){for(const[t,e]of Object.entries(this.triggers))e.enabled=!1}getFirstlineModifier(){let t="";for(const[e,s]of Object.entries(this.triggers))t+=s.enabled?s.modifier:"";return t}}class A{constructor(t){this.Isaac=t,this.state={movePlayer:!1,viewersAttack:!1,heavyRain:!1},this.sended=0}handleMessage(t){let e=!0;if(this.state.movePlayer){let s=this.movePlayer(t);s||(e=!1)}if(this.state.viewersAttack){let s=this.viewersAttack(t);s||(e=!1)}if(this.state.heavyRain){let s=this.heavyRain(t);s||(e=!1)}return e}resetSended(){this.sended=0}disableAll(){this.state.movePlayer=!1,this.state.viewersAttack=!1,this.state.heavyRain=!1}viewersAttack(t){let e=t.text.toUpperCase();return"PLAYER"==e||"ИГРОК"==e?(this.sendToGame({m:"viewersAttack",d:"p"}),!1):"ENEMY"!=e&&"ВРАГ"!=e||(this.sendToGame({m:"viewersAttack",d:"e"}),!1)}movePlayer(t){let e=t.text.toUpperCase();return"LEFT"==e||"ВЛЕВО"==e?(this.sendToGame({m:"movePlayer",d:"l"}),!1):"RIGHT"==e||"ВПРАВО"==e?(this.sendToGame({m:"movePlayer",d:"r"}),!1):"UP"==e||"ВВЕРХ"==e?(this.sendToGame({m:"movePlayer",d:"u"}),!1):"DOWN"!=e&&"ВНИЗ"!=e||(this.sendToGame({m:"movePlayer",d:"d"}),!1)}heavyRain(t){let e=t.text.toUpperCase();if("X"==e||"Х"==e)return this.sendToGame({m:"jason"}),!1}sendToGame(t){this.sended>30||this.Isaac.services.itmr.sendToGame(t,!1,10)}}class P{constructor(t,e,s="en",i=h.NORMAL){this.services=t,this.settings=e,this.lang=s,this.gamemode=i,this.lists={},this.activeUsers={},this.ticksCount=0,this.chatWindow=null,this.timer=null,this.currentAction=null,this.nextAction=null,this.freezedActions=[],this.specialTriggers=new C,this.specialMessageHandler=new A(this),this.isPaused=!1,this.services.twitch&&(this.services.twitch.events.onMessage=this.onMessage.bind(this),this.services.twitch.events.onSub=this.onSubscriber.bind(this),this.services.twitch.events.onBits=this.onDonate.bind(this)),this.services.youtube&&(this.services.youtube.events.onMessage=this.onMessage.bind(this),this.services.youtube.events.onSub=this.onSubscriber.bind(this),this.services.youtube.events.onSuperchat=this.onDonate.bind(this)),this.services.itmr.events.onReconnect=()=>{var t,e;this.sendSettings(),console.log(!1===(null===(t=this.currentAction)||void 0===t?void 0:t.isFirstUpdate)),this.currentAction&&!1===(null===(e=this.currentAction)||void 0===e?void 0:e.isFirstUpdate)&&(this.currentAction.isFirstUpdate=!0)},this.services.itmr.addHandler("changeGameState",({paused:t})=>{this.isPaused=t}),this.services.itmr.addHandler("acceptPoll",()=>{this.acceptPoll()}),this.services.itmr.addHandler("skipPoll",()=>{this.skipPoll()}),this.services.itmr.addHandler("newRun",()=>{this.start()}),this.services.itmr.addHandler("toggleSpecialHandler",({name:t,enable:e})=>{this.services.itmr._log(`Handler ${t} set to ${e}`),this.specialMessageHandler.state[t]=e})}start(){this.timer&&(clearInterval(this.timer),this.freezedActions=[],this.currentAction=null,this.nextAction=null,this.specialTriggers.stopAll(),this.specialMessageHandler.disableAll()),this.services.itmr.clearAll(),this.timer=setInterval(()=>this.tick(),1e3),this.sendSettings().then(()=>{this.loadData().then(()=>{this.currentAction=new _(this,new c["a"]("msg_firstline",""+Object(r["a"])("gameSetupDone",this.lang),this.settings.textpos.l1,l.yellow),null,5),console.log(this)})}),g.forEach(t=>{var e,s,i,n;t.twitch!==(null===(e=this.services)||void 0===e||null===(s=e.twitch)||void 0===s?void 0:s.channel.toLowerCase())&&t.youtube!==(null===(i=this.services)||void 0===i||null===(n=i.youtube)||void 0===n?void 0:n.channel)||this.services.itmr.sendToGame({m:"gift",d:{trinket:t.trinket}},!0)})}tick(){var t,e;if(this.ticksCount++,this.services.itmr.checkOutput(),this.ticksCount%10==0){let t=Object.keys(this.activeUsers);this.services.itmr.sendToGame({m:"randomNames",d:t.length>20?u(t,20):t})}this.services.itmr.isConnected&&(null===(t=(e=this.currentAction).update)||void 0===t||t.call(e))}changeTextPos(t){switch(console.log(this.settings.textpos),t){case"up":this.settings.textpos.l1.Y-=5,this.settings.textpos.l2.Y-=5;break;case"down":this.settings.textpos.l1.Y+=5,this.settings.textpos.l2.Y+=5;break;case"left":this.settings.textpos.l1.X-=5,this.settings.textpos.l2.X-=5;break;case"right":this.settings.textpos.l1.X+=5,this.settings.textpos.l2.X+=5;break;case"reset":this.settings.textpos={l1:{X:16,Y:190},l2:{X:16,Y:215}};break}return this.services.itmr.sendToGame({m:"textpos",d:this.settings.textpos},!0),console.log(this.settings.textpos),this.settings.textpos}onMessage(t){var e;let s=!0;if(this.activeUsers[t.userName]||(this.activeUsers[t.userName]=!0),null!==(e=this.currentAction)&&void 0!==e&&e.handleMessaage){var i,n;let e=null===(i=this.currentAction)||void 0===i||null===(n=i.handleMessaage)||void 0===n?void 0:n.call(i,t);!1===e&&(s=!1)}let a=this.specialMessageHandler.handleMessage(t);var r,o;(!1===a&&(s=!1),this.chatWindow&&!this.chatWindow.closed&&s)&&(console.log("Send message"),null===(r=(o=this.chatWindow).postMessage)||void 0===r||r.call(o,{chatMessage:{type:"basic",user:t.userName,text:t.text,source:t.source}},"*"))}onSubscriber(t){var e,s;this.settings.subsAndBits.subs&&(this.immediateAction(new _(this,new c["a"]("sub_"+p(8),`${Object(r["a"])("newSub",this.lang)} - ${t.userName}`,this.settings.textpos.l1,l.white,l.yellow),null,3)),this.services.itmr.sendToGame({m:"subscriberAction",d:{name:t.userName,time:this.settings.subtime}}),this.chatWindow&&!this.chatWindow.closed&&(null===(e=(s=this.chatWindow).postMessage)||void 0===e||e.call(s,{chatMessage:{type:"subscribe",user:t.userName,source:t.source}},"*")))}onDonate(t){(this.settings.subsAndBits.bits||"tw"!=t.source)&&(this.settings.subsAndBits.superchat||"yt"!=t.source)&&(this.immediateAction(new _(this,new c["a"]("sub_"+p(8),"tw"==t.source?Object(r["a"])("newBits",this.lang):Object(r["a"])("newSuperchat",this.lang),this.settings.textpos.l1,l.white,l.yellow),null,3)),this.services.itmr.sendToGame({m:"bitsAction",d:{amount:t.amount,type:t.type}}))}immediateAction(t){var e,s;null===(e=(s=this.currentAction).freeze)||void 0===e||e.call(s),this.currentAction instanceof _||this.freezedActions.push(this.currentAction),this.currentAction=t}prepareNextAction(){var t,e;if(this.freezedActions.length>0)return;this.specialTriggers.stopAll();let s=d([{name:"event",weight:this.settings.chances.events},{name:"item",weight:this.settings.chances.items},{name:"trinket",weight:this.settings.chances.trinkets},{name:"other",weight:this.settings.chances.other}]);switch(s.name){case"event":this.nextAction=new T(this,this.settings.timings.vote,this.settings.timings.delay);break;case"item":this.nextAction=new y(this,this.settings.timings.vote,this.settings.timings.delay);break;case"trinket":this.nextAction=new I(this,this.settings.timings.vote,this.settings.timings.delay);break;case"other":this.nextAction=new k(this,this.settings.timings.vote,this.settings.timings.delay);break}null===(t=(e=this.nextAction).prepare)||void 0===t||t.call(e)}runNextAction(){var t,e,s,i;this.freezedActions.length>0?this.currentAction=this.freezedActions.pop():(this.currentAction=this.nextAction,this.nextAction=null,null===(t=this.currentAction)||void 0===t||null===(e=t.text)||void 0===e||null===(s=e.firstline)||void 0===s||null===(i=s.setPrefix)||void 0===i||i.call(s,this.specialTriggers.getFirstlineModifier()))}giveGift(){}skipPoll(){var t,e;null===(t=this.currentAction)||void 0===t||null===(e=t.freeze)||void 0===e||e.call(t),this.currentAction=new _(this,new c["a"]("skipvote",Object(r["a"])("skipCurrentPoll",this.lang),this.settings.textpos.l1,l.red,l.yellow))}acceptPoll(){this.currentAction&&this.currentAction.pollTime&&(this.currentAction.pollTime=0)}sendSettings(){return this.services.itmr.sendToGame({m:"settings",d:{textpos:this.settings.textpos,subtime:this.settings.subtime,lang:this.lang}},!0)}loadData(){return this.lists={items:[],trinkets:[],events:[]},this.services.itmr.sendToGame({m:"getItems"},!0).then(t=>{this.lists.items.push(...t.out.active),this.lists.items.push(...t.out.passive),this.lists.items.push(...t.out.familiars),this.lists.trinkets.push(...t.out.trinkets),this.lists.events.push(...t.out.events),console.log(t.out)})}}var E={name:"gamemodeScreen",components:{BigButton:a["a"]},mounted(){this.$services.itmr||this.$router.push("/")},methods:{start(t){this.$root.isaac=new P(this.$services,this.$store.state.settings,this.$store.state.locale,t),this.$root.isaac.start(),this.$router.push("/game")}}},$=E,M=(s("0f61"),s("2877")),O=Object(M["a"])($,i,n,!1,null,null,null);e["default"]=O.exports},"577e":function(t,e,s){var i=s("f5df"),n=String;t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return n(t)}},"6e74":function(t,e,s){"use strict";s.d(e,"d",(function(){return i})),s.d(e,"a",(function(){return n})),s.d(e,"c",(function(){return a})),s.d(e,"b",(function(){return r}));class i{constructor(t,e,s,i){this.userId=t,this.userName=e,this.text=s.trim(),this.source=i}}class n{constructor(t,e,s,i,n){this.userId=t,this.userName=e,this.amount=s,this.type=i,this.source=n}}class a{constructor(t,e,s){this.userId=t,this.userName=e,this.source=s}}class r{constructor(t,e,s){this.userId=t,this.userName=e,this.source=s}}},7156:function(t,e,s){var i=s("1626"),n=s("861d"),a=s("d2bb");t.exports=function(t,e,s){var r,o;return a&&i(r=e.constructor)&&r!==s&&n(o=r.prototype)&&o!==s.prototype&&a(t,o),t}},7192:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));s("e073"),s("74de");class i{constructor(t,e,s=null,i=null,n=null,a=null,r=null,o=null,l=null){this.name=t,this.value=e,this.pos=s,this.color=i,this.blink=n,this.size=a,this.isCenter=r,this.postfix=o,this.prefix=l}setPos(t){this.pos=t}setText(t){this.value=t}setPostfix(t){this.postfix=t}setPrefix(t){this.prefix=t}setColor(t){this.color=t}setBlink(t){this.blink=t}removeBlink(){this.blink=null}setSize(t){this.size=t}setCenter(t){this.isCenter=t}prepare(){let t={};return t["name"]=this.name,t["value"]=this.postfix?`${this.value} ${this.postfix}`:this.value,t["value"]=this.prefix?`${this.prefix} ${t["value"]}`:t["value"],this.pos&&(t["pos"]=this.pos),this.color&&(t["color"]=this.color),this.blink&&(t["blink"]=this.blink),this.size&&(t["size"]=this.size),this.isCenter&&(t["isCenter"]=this.isCenter),t}equals(t){if(null==t)return!1;let e=this.prepare();return(null===e||void 0===e?void 0:e.name)==(null===t||void 0===t?void 0:t.name)&&(null===e||void 0===e?void 0:e.value)==(null===t||void 0===t?void 0:t.value)&&(null===e||void 0===e?void 0:e.pos)==(null===t||void 0===t?void 0:t.pos)&&(null===e||void 0===e?void 0:e.color)==(null===t||void 0===t?void 0:t.color)&&(null===e||void 0===e?void 0:e.blink)==(null===t||void 0===t?void 0:t.blink)&&(null===e||void 0===e?void 0:e.size)==(null===t||void 0===t?void 0:t.size)&&(null===e||void 0===e?void 0:e.postfix)==(null===t||void 0===t?void 0:t.postfix)&&(null===e||void 0===e?void 0:e.prefix)==(null===t||void 0===t?void 0:t.prefix)&&(null===e||void 0===e?void 0:e.isCenter)==(null===t||void 0===t?void 0:t.isCenter)}}},"74de":function(t,e,s){"use strict"},ab36:function(t,e,s){var i=s("861d"),n=s("9112");t.exports=function(t,e){i(e)&&"cause"in e&&n(t,"cause",e.cause)}},aeb0:function(t,e,s){var i=s("9bf2").f;t.exports=function(t,e,s){s in t||i(t,s,{configurable:!0,get:function(){return e[s]},set:function(t){e[s]=t}})}},b980:function(t,e,s){var i=s("d039"),n=s("5c6c");t.exports=!i((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",n(1,7)),7!==t.stack)}))},c745:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));s("14d9");var i=s("6e74");class n{constructor(t){this.apikey="wgnn-wBx-_VT5Nu996o8ylc-t786swbRBySazIA".split("").reverse().join(""),this.streamURL=new URL(t),this.lastMessagesId=[],this.vuewersCount=0,this.channel=null,this.nextPageToken=null,this.consoleStyle="background-color: #FF0000; color: #FFFFFF; border-radius: 100px;padding: 1px 4px;","www.youtube.com"==this.streamURL.hostname||"youtube.com"==this.streamURL.hostname?this.streamId=this.streamURL.searchParams.get("v"):this.streamId=this.streamURL.pathname.substr(1),this.events={onMessage:()=>{},onSub:()=>{},onFollower:()=>{},onSuperchat:()=>{},onConnect:()=>{},onDisconnect:()=>{},onError:()=>{}}}connect(){fetch("https://www.googleapis.com/youtube/v3/videos?id="+this.streamId+"&part=snippet,liveStreamingDetails&key="+this.apikey).then(t=>t.json()).then(t=>{this.chatId=t.items[0].liveStreamingDetails.activeLiveChatId,this.channel=t.items[0].snippet.channelId,this._updateChat(),this.updTimer=setInterval(this._updateChat.bind(this),5e3),this._log("Connected to "+this.chatId),this._log("Channel id: "+this.channel)}).catch(t=>{this._signal("onError",t)})}disconnect(){clearInterval(this.updTimer),this._signal("onDisconnect",null)}updateViewers(){return fetch(`https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails&id=${this.streamId}&fields=items%2FliveStreamingDetails&key=${this.apikey}`).then(t=>t.json()).then(t=>{var e;(null===(e=t.items)||void 0===e?void 0:e.length)>0&&(this.viewersCount=t.items[0].liveStreamingDetails.concurrentViewers)})}_updateChat(){fetch("https://www.googleapis.com/youtube/v3/liveChat/messages?liveChatId="+this.chatId+"&part=id,snippet,authorDetails&maxResults=100&key="+this.apikey+(this.nextPageToken?"&nextPageToken="+this.nextPageToken:"")).then(t=>t.json()).then(t=>{t.items.forEach(e=>{if(null!==t&&void 0!==t&&t.nextPageToken&&(this.nextPageToken=t.nextPageToken),!this.lastMessagesId.includes(e.id)){if(this.lastMessagesId.length>1e3&&(this.lastMessagesId=this.lastMessagesId.splice(100,900)),this.lastMessagesId.push(e.id),"textMessageEvent"!=e.snippet.type)return"superChatEvent"==e.snippet.type?(this._signal("onSuperchat",new i["a"](e.snippet.authorChannelId,e.authorDetails.displayName,e.snippet.superChatDetails.tier>5?5:e.snippet.superChatDetails.tier,1,"yt")),void this._log("Get donate from "+e.authorDetails.displayName+" - "+e.snippet.superChatDetails.amountMicros)):"superStickerEvent"==e.snippet.type?(this._signal("onSuperchat",new i["a"](e.snippet.authorChannelId,e.authorDetails.displayName,e.snippet.superStickerDetails.tier>5?5:e.snippet.superStickerDetails.tier,1,"yt")),void this._log("Get donate from "+e.authorDetails.displayName+" - "+e.snippet.superChatDetails.amountMicros)):"newSponsorEvent"==e.snippet.type?(this._signal("onSub",new i["c"](e.snippet.authorChannelId,e.authorDetails.displayName,"yt")),void this._log("New subscriber "+e.authorDetails.displayName)):void 0;this._signal("onMessage",new i["d"](e.snippet.authorChannelId,e.authorDetails.displayName,e.snippet.displayMessage,"yt"))}})})}_log(t){console.log("%cYoutube%c "+t,this.consoleStyle,"")}_signal(t,e){this.events[t](e)}}},cb19:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s("7192"),n=s("fece");class a{constructor(t=8666,e="en"){this.stats={success:0,errors:0},this.isConnected=!1,this.events={onConnect:()=>{},onReconnect:()=>{}},this.port=t,this.lang=e,this.handlers={},this.checkOutputTimer=null,this.searchServerTimer=setInterval(this.search.bind(this),1e3),this.consoleStyle="background-color: #EFD8CD; color: #473A3C; border-radius: 100px;padding: 1px 4px;",this._log("Search game server...")}search(){fetch("http://localhost:"+this.port,{method:"POST",body:'||{"m":"ping"}||\n'}).then(t=>t.json()).then(t=>{"pong"==t.out&&(this._log("Game server found"),clearInterval(this.searchServerTimer),this.connect())}).catch(t=>{})}stopSearch(){clearInterval(this.searchServerTimer)}testConnect(){setInterval(()=>{fetch("http://localhost:"+this.port,{method:"POST",body:'||{"m":"ping"}||\n'}).then(t=>t.json()).then(t=>{"pong"==t.out&&this.stats.success++}).catch(t=>{this.stats.errors++}),this._log(`${this.stats.success}|${this.stats.errors} / ${Math.round(this.stats.errors/(this.stats.success+this.stats.errors)*100,2)}%`)},250)}connect(){this.sendToGame({m:"connect"}).then(t=>{"success"==t.out&&(this._log("Game connected"),this.isConnected=!0,this.clearAll().then(()=>{this.sendToGame({m:"addText",d:[new i["a"]("gameConnected",Object(n["a"])("gameConnected",this.lang)).prepare()]}),this._signal("onConnect")}))})}clearAll(){return Promise.all([this.sendToGame({m:"removePollframes"},!0),this.sendToGame({m:"removeProgressBar"},!0),this.sendToGame({m:"clearText"},!0)])}sendToGame(t,e=!1,s=0){return new Promise((i,n)=>{this._send(t,s,e).then(t=>t.json()).catch(t=>{console.error(t),n(t)}).then(t=>{this.isConnected=!0,i(t)}).catch(t=>{console.error(t)})})}checkOutput(){fetch("http://localhost:"+this.port,{method:"POST",body:'||{"m":"out"}||\n'}).then(t=>t.json()).then(t=>{this.isConnected||(console.log("send reconnect"),this.sendToGame({m:"removeText",d:["siteMessage"]}),this._signal("onReconnect")),this.isConnected=!0,t.out.forEach(t=>{this.handlers[t.c]?this.handlers[t.c](t.d):this._log("Not found handler for "+t.c)})}).catch(t=>{this.isConnected=!1,this._log("Connection to Isaac skip request","warn")})}addHandler(t,e){this.handlers[t]=e}removeHandler(t){delete this.handlers[t]}_signal(t,e=null){this.events[t]&&this.events[t](e)}_log(t,e="log"){console[e]("%cITMR%c "+t,this.consoleStyle,"")}_send(t,e=1,s=!1){return fetch("http://localhost:"+this.port,{method:"POST",body:`||${JSON.stringify(t)}||\n`}).catch(function(i){if(this.isConnected=!1,this._log("Connection to Isaac is broken","error"),e>3&&!s)throw i;if(e>6&&s)throw i;return this._send(t,e+1,s)}.bind(this))}}},d2bb:function(t,e,s){var i=s("e330"),n=s("825a"),a=s("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,s={};try{t=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),t(s,[]),e=s instanceof Array}catch(r){}return function(s,i){return n(s),a(i),e?t(s,i):s.__proto__=i,s}}():void 0)},d9e2:function(t,e,s){var i=s("23e7"),n=s("da84"),a=s("2ba4"),r=s("e5cb"),o="WebAssembly",l=n[o],h=7!==Error("e",{cause:7}).cause,c=function(t,e){var s={};s[t]=r(t,e,h),i({global:!0,constructor:!0,arity:1,forced:h},s)},u=function(t,e){if(l&&l[t]){var s={};s[t]=r(o+"."+t,e,h),i({target:o,stat:!0,constructor:!0,arity:1,forced:h},s)}};c("Error",(function(t){return function(e){return a(t,this,arguments)}})),c("EvalError",(function(t){return function(e){return a(t,this,arguments)}})),c("RangeError",(function(t){return function(e){return a(t,this,arguments)}})),c("ReferenceError",(function(t){return function(e){return a(t,this,arguments)}})),c("SyntaxError",(function(t){return function(e){return a(t,this,arguments)}})),c("TypeError",(function(t){return function(e){return a(t,this,arguments)}})),c("URIError",(function(t){return function(e){return a(t,this,arguments)}})),u("CompileError",(function(t){return function(e){return a(t,this,arguments)}})),u("LinkError",(function(t){return function(e){return a(t,this,arguments)}})),u("RuntimeError",(function(t){return function(e){return a(t,this,arguments)}}))},e073:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));class i{constructor(t,e,s,i){this.r=t/255,this.g=e/255,this.b=s/255,this.a=i}}},e342:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));s("14d9");var i=s("6e74");class n{constructor(t){this.channel=t,this.userId=null,this.viewersCount=0,this.apikey="vtr91vw1dzji7piypq7r13itr6is2i",this.botname="justinfan666",this.server="irc-ws.chat.twitch.tv",this.consoleStyle="background-color: #6441A4; color: #FFFFFF; border-radius: 100px;padding: 1px 4px;",this.lastFollowers=[],this.plannedDisconnect=!1,this.events={onMessage:()=>{},onSub:()=>{},onFollower:()=>{},onBits:()=>{},onConnect:()=>{},onDisconnect:()=>{},onError:()=>{}}}connect(){window.location.protocol.includes("https")?this.webSocket=new WebSocket("wss://"+this.server+":443/","irc"):this.webSocket=new WebSocket("ws://"+this.server+":80/","irc"),this.webSocket.onmessage=this.onMessage.bind(this),this.webSocket.onerror=this.onError.bind(this),this.webSocket.onclose=this.onClose.bind(this),this.webSocket.onopen=this.onOpen.bind(this)}startCheckNewFollowers(){this.checkFollowersFrom=Date.now();let t=setInterval((()=>{this.userId&&(clearInterval(t),this._checkFollowers(),this.updFollowersTimer=setInterval(this._checkFollowers.bind(this),18e4))}).bind(this),500)}stopCheckNewFollowers(){clearInterval(this.updFollowersTimer)}updateViewers(){return fetch("https://api.twitch.tv/helix/streams?user_login="+this.channel,{headers:{"Client-ID":this.apikey}}).then(t=>t.json()).then(t=>{t.stream&&(this.viewersCount=t.stream.viewers)})}onMessage(t){if(null==t)return;let e=this._parseMessage(t.data);if(null!=e)if("PING"!==e.command)if("ROOMSTATE"!==e.command)if("USERNOTICE"==e.command&&(e.tags["msg-id"].includes("sub")||e.tags["msg-id"].includes("gift")))e.tags.hasOwnProperty("msg-param-recipient-display-name")?(this._signal("onSub",new i["c"](e.tags["msg-param-recipient-id"],e.tags["msg-param-recipient-display-name"],"tw")),this._log("New gifted subscriber "+e.tags["msg-param-recipient-display-name"])):this._signal("onSub",new i["c"](e.tags["user-id"],e.tags["display-name"],"tw")),this._log("New subscriber "+e.tags["display-name"]);else if("PRIVMSG"==e.command&&e.tags.hasOwnProperty("bits")){let t=parseFloat(e.tags["bits"]),s=1,n=t>10?10:t;if(t<10)return;t/100>=1&&(s=2,n=Math.round(t/100)),t/1e3>=1&&(s=3,n=Math.round(t/1e3)),t/5e3>=1&&(s=4,n=Math.round(t/5e3)),t/1e4>=1&&(s=5,n=Math.round(t/1e4)),n=n>10?10:n,this._signal("onBits",new i["a"](e.tags["user-id"],e.tags["display-name"],n,s,"tw")),this._log("Get donate from "+e.tags["display-name"]+" - "+e.tags["bits"])}else"PRIVMSG"==e.command&&this._signal("onMessage",new i["d"](e.tags["user-id"],e.tags["display-name"],e.message,"tw"));else this.userId=e.tags["room-id"];else this.webSocket.send("PONG :"+e.message)}onError(t){this._signal("onError",t),this._log("Error: "),console.log(t)}onClose(){this.plannedDisconnect?this._signal("onDisconnect"):this.connect(),this._log("Disconnect from websocket")}onOpen(){null!==this.webSocket&&1===this.webSocket.readyState&&(this._log("Connected to websocket"),this.webSocket.send("CAP REQ :twitch.tv/tags twitch.tv/commands twitch.tv/membership"),this.webSocket.send("NICK "+this.botname),this.webSocket.send("JOIN #"+this.channel.toLowerCase()),this._signal("onConnect"))}close(){this.plannedDisconnect=!0,this.webSocket&&this.webSocket.close()}_signal(t,e){this.events[t](e)}_checkFollowers(){fetch("https://api.twitch.tv/helix/users/follows?first=100&to_id="+this.userId,{headers:{"Client-ID":this.apikey}}).then(t=>t.json()).then(t=>{t.data.forEach(t=>{this.lastFollowers.includes(t.from_id)||(this.lastFollowers>1e3&&(this.lastFollowers=this.lastFollowers.splice(100,900)),this.lastFollowers.push(t.from_id),new Date(t.followed_at)<this.checkFollowersFrom||(this._signal("onFollower",new i["b"](t.from_id,t.from_name,"tw")),this._log("New follower "+t.from_name)))})})}_log(t){console.log("%cTwitch%c "+t,this.consoleStyle,"")}_parseMessage(t){let e={message:null,tags:null,command:null,original:t,channel:null,username:null};if("@"===t[0]){let s=t.indexOf(" "),i=t.indexOf(" ",s+1),n=t.indexOf(" ",i+1),a=t.indexOf(" ",n+1),r=t.indexOf(":",a+1),o=null!=t.slice(0,s)?t.slice(0,s).substr(1).split(";"):[],l={};o.forEach(t=>{let e=t.split("=");l[e[0]]=e[1]}),e.tags=l,e.username=t.slice(s+2,t.indexOf("!")),e.command=t.slice(i+1,n),e.channel=t.slice(n+1,a),e.message=t.slice(r+1)}else t.startsWith("PING")&&(e.command="PING",e.message=t.split(":")[1]);return e}}},e391:function(t,e,s){var i=s("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:i(t)}},e5cb:function(t,e,s){"use strict";var i=s("d066"),n=s("1a2d"),a=s("9112"),r=s("3a9b"),o=s("d2bb"),l=s("e893"),h=s("aeb0"),c=s("7156"),u=s("e391"),d=s("ab36"),p=s("0d26"),m=s("b980"),v=s("83ab"),g=s("c430");t.exports=function(t,e,s,f){var x="stackTraceLimit",b=f?2:1,y=t.split("."),w=y[y.length-1],T=i.apply(null,y);if(T){var I=T.prototype;if(!g&&n(I,"cause")&&delete I.cause,!s)return T;var k=i("Error"),_=e((function(t,e){var s=u(f?e:t,void 0),i=f?new T(t):new T;return void 0!==s&&a(i,"message",s),m&&a(i,"stack",p(i.stack,2)),this&&r(I,this)&&c(i,this,_),arguments.length>b&&d(i,arguments[b]),i}));if(_.prototype=I,"Error"!==w?o?o(_,k):l(_,k,{name:!0}):v&&x in T&&(h(_,T,x),h(_,T,"prepareStackTrace")),l(_,T),!g)try{I.name!==w&&a(I,"name",w),I.constructor=_}catch(C){}return _}}},f5df:function(t,e,s){var i=s("00ee"),n=s("1626"),a=s("c6b6"),r=s("b622"),o=r("toStringTag"),l=Object,h="Arguments"==a(function(){return arguments}()),c=function(t,e){try{return t[e]}catch(s){}};t.exports=i?a:function(t){var e,s,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(s=c(e=l(t),o))?s:h?a(e):"Object"==(i=a(e))&&n(e.callee)?"Arguments":i}},fece:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s("3f83"),n=s("9478");function a(t,e){return"ru"==e?n["a"].strings[t]?n["a"].strings[t]:`!${t}!`:i["a"].strings[t]?i["a"].strings[t]:`!${t}!`}}}]);
//# sourceMappingURL=gamemode-screen.e4b7367f.js.map